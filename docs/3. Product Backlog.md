# Product Backlog

**Product:** Wani - Cross-Border Payment System  
**Version:** 1.0  
**Last Updated:** 2024-12-20  
**Owner:** [Tu Nombre]

---

## Backlog Summary

**Total Items:** 42 User Stories  
**Must Have (MVP):** 23 stories (136 Story Points)  
**Should Have (Post-MVP):** 12 stories (58 Story Points)  
**Could Have (Future):** 7 stories (34 Story Points)  
**Estimated Sprints for MVP:** 8 sprints (16 weeks) @ 17 points velocity

**Target MVP Completion:** 16 weeks (4 months)

---

## Epic Overview

### üéØ Epic 1: Authentication & User Management

**Stories:** 5  
**Total Points:** 21  
**Priority:** Must Have  
**Description:** User registration, login, KYC verification, profile management

### üí∞ Epic 2: Wallet Management

**Stories:** 4  
**Total Points:** 21  
**Priority:** Must Have  
**Description:** Create wallet, view balance, transaction history, manage funds

### üåê Epic 3: Cross-Border Transfers

**Stories:** 3  
**Total Points:** 21  
**Priority:** Must Have  
**Description:** Send money USA/CAN ‚Üí Mexico using Stellar/USDC

### üí≥ Epic 4: Payments (NFC/QR)

**Stories:** 5  
**Total Points:** 34  
**Priority:** Must Have  
**Description:** Pay in merchants using NFC or QR code

### üè™ Epic 5: Merchant Features

**Stories:** 4  
**Total Points:** 21  
**Priority:** Must Have  
**Description:** Business app, accept payments, dashboard, commission management

### üí∏ Epic 6: Cash-Out Integration

**Stories:** 2  
**Total Points:** 13  
**Priority:** Must Have  
**Description:** Transfer funds to Bitso and bank accounts

### üîî Epic 7: Notifications & Communication

**Stories:** 2  
**Total Points:** 5  
**Priority:** Must Have  
**Description:** Push notifications, email notifications

### üìä Epic 8: Analytics & Reporting (Post-MVP)

**Stories:** 4  
**Total Points:** 21  
**Priority:** Should Have  
**Description:** Merchant analytics, user insights, transaction reports

### üéÅ Epic 9: Rewards & Loyalty (Post-MVP)

**Stories:** 3  
**Total Points:** 13  
**Priority:** Should Have  
**Description:** Cashback program, referral system, merchant loyalty

### üîê Epic 10: Advanced Security (Post-MVP)

**Stories:** 2  
**Total Points:** 8  
**Priority:** Should Have  
**Description:** Biometric auth, 2FA, fraud detection

---

## Prioritized Backlog

### üî¥ MUST HAVE (MVP Critical)

---

#### 1. User Registration with Email/Password

**ID:** US-001  
**Epic:** Authentication & User Management  
**Story:** Como usuario nuevo, quiero registrarme con mi email y contrase√±a para crear una cuenta en Wani

**Acceptance Criteria:**

- [ ] Formulario de registro con: email, contrase√±a, nombre completo, tel√©fono
- [ ] Validaci√≥n de email format
- [ ] Validaci√≥n de contrase√±a (m√≠nimo 8 caracteres, 1 may√∫scula, 1 n√∫mero)
- [ ] Email de verificaci√≥n enviado autom√°ticamente
- [ ] Error claro si email ya existe
- [ ] Registro completo en <2 minutos

**Technical Notes:**

- Stack: React/React Native (frontend) + FastAPI (backend) + Supabase Auth
- Dependencies: None (primera story)
- Complexity Factors: Integraci√≥n con Supabase Auth, validaciones robustas, email service setup
- Files affected: auth.service.ts, RegisterForm.tsx, auth routes (backend)

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 2. User Login & JWT Token Management

**ID:** US-002  
**Epic:** Authentication & User Management  
**Story:** Como usuario registrado, quiero hacer login con mi email y contrase√±a para acceder a mi cuenta

**Acceptance Criteria:**

- [ ] Formulario de login con email + password
- [ ] Retorna access token (15 min) + refresh token (7 d√≠as)
- [ ] Tokens guardados de forma segura (Keychain iOS, Keystore Android)
- [ ] Redirecci√≥n autom√°tica a dashboard despu√©s de login
- [ ] Mensaje de error claro si credenciales incorrectas
- [ ] Rate limiting: m√°ximo 5 intentos por 15 minutos

**Technical Notes:**

- Stack: Frontend (login form) + Backend (JWT generation)
- Dependencies: US-001 (Registration debe existir primero)
- Complexity Factors: JWT refresh flow, secure token storage, rate limiting
- Security: bcrypt password hashing, rate limiting middleware

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 3. KYC Basic - Document Upload

**ID:** US-003  
**Epic:** Authentication & User Management  
**Story:** Como usuario, quiero subir mi INE/Pasaporte para verificar mi identidad y poder usar la plataforma

**Acceptance Criteria:**

- [ ] Upload de foto frontal y trasera de INE (o pasaporte)
- [ ] Preview antes de enviar
- [ ] M√°ximo 5MB por imagen
- [ ] Formatos aceptados: JPG, PNG, PDF
- [ ] Status visible: "Pending Review", "Approved", "Rejected"
- [ ] Notificaci√≥n push/email cuando status cambia

**Technical Notes:**

- Stack: React Native (camera + image picker) + FastAPI + S3/Cloudinary
- Dependencies: US-001, US-002 (user must be logged in)
- Complexity Factors: File upload, image compression, S3 integration, KYC verification flow
- External: Stripe Identity o Onfido (fase 2), manual review (MVP)

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 4. Create Stellar Wallet Automatically

**ID:** US-004  
**Epic:** Wallet Management  
**Story:** Como usuario registrado, quiero que se cree autom√°ticamente una wallet Stellar para m√≠ sin que tenga que hacer nada

**Acceptance Criteria:**

- [ ] Wallet Stellar creada autom√°ticamente al completar registro
- [ ] Stellar public key y secret key generados
- [ ] Secret key encriptado y guardado en base de datos
- [ ] Usuario ve su wallet address (public key) en perfil
- [ ] Balance inicial: 0.00 MXN / 0.000000 USDC
- [ ] Wallet status: Active

**Technical Notes:**

- Stack: Backend (FastAPI) + Stellar SDK (py-stellar-base)
- Dependencies: US-001 (trigger after user registration)
- Complexity Factors: Stellar keypair generation, encryption of secret key, database schema for wallets
- Security: Secret key MUST be encrypted with Fernet before storing

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 5. View Wallet Balance (MXN)

**ID:** US-005  
**Epic:** Wallet Management  
**Story:** Como usuario, quiero ver mi balance en pesos mexicanos (MXN) en la pantalla principal de mi app

**Acceptance Criteria:**

- [ ] Muestra balance en formato currency: $1,234.56 MXN
- [ ] Balance actualizado en tiempo real (auto-refresh cada 30s o pull-to-refresh)
- [ ] Indicador visual si balance es 0
- [ ] Bot√≥n para "Cargar dinero" visible
- [ ] Loading state mientras carga balance

**Technical Notes:**

- Stack: React Native (frontend) + FastAPI (balance endpoint)
- Dependencies: US-004 (wallet must exist)
- Complexity Factors: Real-time updates, currency formatting, TanStack Query caching
- Performance: Cache 30 seconds, invalidate on transactions

**Estimation:** 3 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 6. Load Wallet - Bank Transfer (SPEI Mexico)

**ID:** US-006  
**Epic:** Wallet Management  
**Story:** Como usuario mexicano, quiero cargar dinero a mi wallet Wani desde mi banco mediante transferencia SPEI

**Acceptance Criteria:**

- [ ] Muestra CLABE √∫nica para el usuario
- [ ] Instrucciones claras de c√≥mo hacer SPEI
- [ ] Fondos reflejados en wallet en <10 minutos
- [ ] Notificaci√≥n push cuando fondos llegan
- [ ] Historial de dep√≥sitos visible
- [ ] Monto m√≠nimo: $100 MXN

**Technical Notes:**

- Stack: Backend + Integraci√≥n con banco partner o Bitso
- Dependencies: US-004, US-005
- Complexity Factors: Webhook para notificar cuando SPEI llega, reconciliaci√≥n de pagos
- External Integration: Bitso API o banco partner

**Estimation:** 13 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 7. Load Wallet - Circular (USA/Canada Accounts)

**ID:** US-007  
**Epic:** Wallet Management  
**Story:** Como usuario en USA o Canad√°, quiero cargar dinero a mi wallet Wani desde mi cuenta Circular

**Acceptance Criteria:**

- [ ] Conectar cuenta Circular (OAuth o API key)
- [ ] Seleccionar monto a transferir (USD o CAD)
- [ ] Confirmaci√≥n antes de transferir
- [ ] Conversi√≥n autom√°tica USD/CAD ‚Üí USDC
- [ ] Fondos reflejados en <5 minutos
- [ ] Notificaci√≥n push cuando fondos llegan
- [ ] Comisi√≥n: 1-1.5% (mostrar antes de confirmar)

**Technical Notes:**

- Stack: Backend + Circular API integration
- Dependencies: US-004, US-005
- Complexity Factors: OAuth flow, Circular API integration, currency conversion, webhook handling
- External: Circular API

**Estimation:** 13 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 8. Send Money Cross-Border (USA/CAN ‚Üí Mexico)

**ID:** US-008  
**Epic:** Cross-Border Transfers  
**Story:** Como usuario en USA/Canad√°, quiero enviar dinero a un usuario en M√©xico de forma r√°pida y barata

**Acceptance Criteria:**

- [ ] Formulario: destinatario (Wani ID o wallet address), monto, nota opcional
- [ ] Muestra tipo de cambio actual USD/CAD ‚Üí MXN
- [ ] Muestra comisi√≥n antes de confirmar (1-1.5%)
- [ ] Confirmaci√≥n de env√≠o
- [ ] Transacci√≥n Stellar completada en <10 segundos
- [ ] Destinatario recibe notificaci√≥n inmediata
- [ ] Ambos usuarios ven transacci√≥n en historial

**Technical Notes:**

- Stack: Frontend (send form) + Backend + Stellar SDK
- Dependencies: US-004, US-005, US-006 o US-007 (user must have balance)
- Complexity Factors: Stellar transaction submission, idempotency, exchange rate API, error handling
- Blockchain: Stellar transaction with USDC
- Performance Target: <10 seconds end-to-end

**Estimation:** 13 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 9. Receive Money (Cross-Border or Local)

**ID:** US-009  
**Epic:** Cross-Border Transfers  
**Story:** Como usuario receptor, quiero recibir dinero en mi wallet Wani y ver mi balance actualizado inmediatamente

**Acceptance Criteria:**

- [ ] Recibo notificaci√≥n push cuando alguien me env√≠a dinero
- [ ] Balance actualizado autom√°ticamente
- [ ] Veo detalles: qui√©n envi√≥, cu√°nto, cu√°ndo, nota
- [ ] Puedo ver recibo digital de la transacci√≥n
- [ ] Transacci√≥n aparece en historial

**Technical Notes:**

- Stack: Backend (webhook listener) + Push notifications + Frontend (balance refresh)
- Dependencies: US-008 (inverse operation)
- Complexity Factors: Webhook from Stellar, push notification delivery, real-time balance update
- Performance: Notification within 5 seconds of transaction

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 10. Transaction History

**ID:** US-010  
**Epic:** Wallet Management  
**Story:** Como usuario, quiero ver el historial de todas mis transacciones (recibidas, enviadas, pagos, cash-outs)

**Acceptance Criteria:**

- [ ] Lista de transacciones ordenada por fecha (m√°s reciente primero)
- [ ] Para cada transacci√≥n: tipo, monto, fecha/hora, status, contraparte
- [ ] Filtros: tipo (recibidas, enviadas, pagos), fecha, status
- [ ] Paginaci√≥n: 20 transacciones por p√°gina
- [ ] Detalle completo al hacer click en transacci√≥n
- [ ] Exportar a PDF/CSV (opcional para MVP)

**Technical Notes:**

- Stack: Frontend (list view) + Backend (paginated API)
- Dependencies: US-008, US-009 (transactions must exist)
- Complexity Factors: Pagination, filtering, sorting, date formatting
- Performance: Database indexing on user_id + created_at

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 11. Generate QR Code for Payment (User Side)

**ID:** US-011  
**Epic:** Payments (NFC/QR)  
**Story:** Como usuario, quiero generar un QR code para que un comerciante me cobre escane√°ndolo

**Acceptance Criteria:**

- [ ] Generar QR din√°mico con: user ID, monto, timestamp
- [ ] QR v√°lido por 5 minutos (expiraci√≥n autom√°tica)
- [ ] Comerciante escanea QR y cobra
- [ ] Usuario confirma pago en su app
- [ ] Balance actualizado inmediatamente
- [ ] Recibo digital generado

**Technical Notes:**

- Stack: React Native (QR generation) + Backend (payment processing)
- Dependencies: US-005 (user must have balance)
- Complexity Factors: QR code generation, expiration logic, payment confirmation flow
- Libraries: react-native-qrcode-svg

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 12. Pay with NFC (User Side)

**ID:** US-012  
**Epic:** Payments (NFC/QR)  
**Story:** Como usuario, quiero pagar en un comercio Wani usando NFC (acercando mi celular) de forma r√°pida y segura

**Acceptance Criteria:**

- [ ] Activar NFC en app
- [ ] Acercar celular a celular del comerciante
- [ ] Mostrar monto a pagar y comerciante
- [ ] Confirmar pago (biometr√≠a o PIN - puede ser PIN simple para MVP)
- [ ] Pago procesado en <3 segundos
- [ ] Balance actualizado inmediatamente
- [ ] Recibo digital visible

**Technical Notes:**

- Stack: React Native (expo-nfc) + Backend
- Dependencies: US-005 (balance check)
- Complexity Factors: NFC implementation iOS/Android, payment confirmation, error handling
- Libraries: expo-nfc (primary), react-native-nfc-manager (backup)
- Platform: iOS 13+, Android 5.0+ with NFC

**Estimation:** 13 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 13. Scan QR to Pay (User Side)

**ID:** US-013  
**Epic:** Payments (NFC/QR)  
**Story:** Como usuario, quiero escanear el QR de un comercio para pagarle de forma r√°pida

**Acceptance Criteria:**

- [ ] Abrir esc√°ner de QR en app
- [ ] Escanear QR del comerciante (est√°tico o din√°mico)
- [ ] Mostrar nombre del comerciante y monto
- [ ] Ingresar monto si QR es est√°tico
- [ ] Confirmar pago
- [ ] Pago procesado en <3 segundos
- [ ] Recibo digital

**Technical Notes:**

- Stack: React Native (expo-camera + expo-barcode-scanner) + Backend
- Dependencies: US-005
- Complexity Factors: Camera permissions, QR parsing, static vs dynamic QR handling
- Libraries: expo-camera, expo-barcode-scanner

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 14. Cash-Out to Bitso

**ID:** US-014  
**Epic:** Cash-Out Integration  
**Story:** Como usuario, quiero enviar mi balance Wani a Bitso para convertir a pesos y sacar a mi banco

**Acceptance Criteria:**

- [ ] Conectar cuenta Bitso (API key o OAuth)
- [ ] Seleccionar monto a transferir
- [ ] Muestra comisi√≥n antes de confirmar
- [ ] Confirmaci√≥n del usuario
- [ ] Fondos llegan a Bitso en <10 minutos
- [ ] Notificaci√≥n cuando transferencia completa
- [ ] Transaction history actualizado

**Technical Notes:**

- Stack: Backend + Bitso API integration
- Dependencies: US-005 (user must have balance)
- Complexity Factors: Bitso API integration, webhook handling, reconciliation
- External: Bitso API
- Commission: TBD (check Bitso fees)

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 15. Cash-Out to Bank Account (via Bitso)

**ID:** US-015  
**Epic:** Cash-Out Integration  
**Story:** Como usuario, quiero transferir mi balance Wani directamente a mi cuenta bancaria mexicana

**Acceptance Criteria:**

- [ ] Agregar cuenta bancaria (CLABE)
- [ ] Seleccionar monto a transferir
- [ ] Muestra comisi√≥n y tiempo estimado antes de confirmar
- [ ] Confirmaci√≥n del usuario
- [ ] Fondos llegan al banco en <24 horas
- [ ] Notificaci√≥n cuando transferencia completa
- [ ] Comprobante digital descargable

**Technical Notes:**

- Stack: Backend + Bitso API (Bitso hace la transferencia SPEI)
- Dependencies: US-014 (uses Bitso as intermediary)
- Complexity Factors: Bank account validation, SPEI integration via Bitso
- External: Bitso API ‚Üí SPEI
- Time: Usually <2 hours but can take up to 24h

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 16. Push Notifications (Transaction Events)

**ID:** US-016  
**Epic:** Notifications & Communication  
**Story:** Como usuario, quiero recibir notificaciones push en mi celular cuando hay eventos importantes (dinero recibido, pago realizado, etc.)

**Acceptance Criteria:**

- [ ] Notificaci√≥n cuando recibo dinero
- [ ] Notificaci√≥n cuando env√≠o dinero
- [ ] Notificaci√≥n cuando realizo pago en comercio
- [ ] Notificaci√≥n cuando cash-out completo
- [ ] Notificaci√≥n cuando KYC aprobado/rechazado
- [ ] Usuario puede desactivar notificaciones en settings

**Technical Notes:**

- Stack: Backend (Celery tasks) + Expo Push Notifications
- Dependencies: Multiple (US-008, US-009, US-011, US-012, US-013, US-014)
- Complexity Factors: Push notification service setup, notification templates, user preferences
- Service: Expo Push Notifications

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 17. Merchant Registration

**ID:** US-017  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero registrarme en Wani Business para empezar a aceptar pagos

**Acceptance Criteria:**

- [ ] Formulario de registro con: nombre del negocio, tipo de negocio, direcci√≥n, email, tel√©fono
- [ ] Subir RFC (opcional para MVP)
- [ ] Seleccionar plan: Pay-as-you-go (1%) o Suscripci√≥n (pr√≥ximamente)
- [ ] Confirmaci√≥n de t√©rminos de servicio
- [ ] Cuenta de comerciante creada
- [ ] Acceso a Wani Business app

**Technical Notes:**

- Stack: React Native Business app + Backend (merchant endpoints)
- Dependencies: US-001 (similar flow to user registration)
- Complexity Factors: Merchant-specific fields, business verification, plan selection
- Database: merchants table

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 18. Generate Static QR Code (Merchant)

**ID:** US-018  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero generar un QR est√°tico que mis clientes puedan escanear para pagarme

**Acceptance Criteria:**

- [ ] Generar QR est√°tico con merchant ID
- [ ] QR no expira (v√°lido permanentemente)
- [ ] Cliente escanea QR e ingresa monto
- [ ] QR descargable para imprimir
- [ ] M√∫ltiples tama√±os disponibles (peque√±o, mediano, grande)
- [ ] Preview antes de descargar

**Technical Notes:**

- Stack: Backend (QR generation) + React Native Business
- Dependencies: US-017 (merchant must exist)
- Complexity Factors: QR generation with embedded merchant ID, downloadable asset
- Format: PNG, PDF

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 19. Accept Payment via NFC (Merchant)

**ID:** US-019  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero aceptar pagos NFC desde mi celular sin necesidad de hardware adicional

**Acceptance Criteria:**

- [ ] Activar NFC en Wani Business app
- [ ] Ingresar monto a cobrar
- [ ] Cliente acerca su celular
- [ ] Pago procesado en <3 segundos
- [ ] Dinero llega a wallet instant√°neamente
- [ ] Recibo digital generado
- [ ] Comisi√≥n descontada: 1% (pay-as-you-go)

**Technical Notes:**

- Stack: React Native Business (expo-nfc) + Backend
- Dependencies: US-012 (inverse of user NFC payment)
- Complexity Factors: NFC merchant mode, commission calculation, instant settlement
- Commission: Deducted automatically before crediting merchant wallet

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 20. Accept Payment via QR (Merchant)

**ID:** US-020  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero generar un QR din√°mico con monto espec√≠fico para que el cliente pague

**Acceptance Criteria:**

- [ ] Ingresar monto a cobrar
- [ ] Generar QR din√°mico (expira en 5 minutos)
- [ ] Cliente escanea QR desde su Wani app
- [ ] Pago procesado instant√°neamente
- [ ] Dinero llega a wallet menos 1% comisi√≥n
- [ ] Recibo digital generado

**Technical Notes:**

- Stack: React Native Business + Backend
- Dependencies: US-013 (inverse of user QR scan)
- Complexity Factors: Dynamic QR generation, expiration logic
- Commission: 1% deducted

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 21. Merchant Dashboard - Transaction List

**ID:** US-021  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero ver todas mis transacciones recibidas para llevar control de mis ventas

**Acceptance Criteria:**

- [ ] Lista de todas las transacciones recibidas
- [ ] Para cada transacci√≥n: cliente (an√≥nimo ID), monto bruto, comisi√≥n, monto neto, fecha/hora
- [ ] Filtros: fecha, m√©todo de pago (NFC vs QR)
- [ ] Resumen del d√≠a: ventas totales, comisiones, neto
- [ ] Paginaci√≥n: 20 transacciones por p√°gina

**Technical Notes:**

- Stack: React Native Business + Backend
- Dependencies: US-019, US-020 (transactions must exist)
- Complexity Factors: Merchant-specific filtering, commission display
- Performance: Indexed queries on merchant_id + created_at

**Estimation:** 5 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 22. Email Notifications (Critical Events)

**ID:** US-022  
**Epic:** Notifications & Communication  
**Story:** Como usuario, quiero recibir emails cuando hay eventos cr√≠ticos (registro, KYC aprobado, cash-out completado)

**Acceptance Criteria:**

- [ ] Email de bienvenida al registrarse
- [ ] Email de verificaci√≥n de email
- [ ] Email cuando KYC aprobado/rechazado
- [ ] Email cuando cash-out >$10,000 MXN completo
- [ ] Templates profesionales (HTML)
- [ ] Links a la app incluidos

**Technical Notes:**

- Stack: Backend (Celery tasks) + Email service (Resend/SendGrid)
- Dependencies: Multiple user stories
- Complexity Factors: Email templates, HTML design, deliverability
- Service: Resend (preferred) or SendGrid

**Estimation:** 3 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

#### 23. Basic Error Handling & Retry Logic

**ID:** US-023  
**Epic:** Core Infrastructure  
**Story:** Como sistema, quiero manejar errores de forma robusta y reintentar operaciones fallidas cuando sea apropiado

**Acceptance Criteria:**

- [ ] Stellar transactions se reintentan 3 veces si fallan
- [ ] Webhooks se reintentan con exponential backoff
- [ ] Errores cr√≠ticos loguean a Sentry
- [ ] Usuario ve mensajes de error claros (no errores t√©cnicos)
- [ ] Transacciones fallidas marcan status "failed" con error_message

**Technical Notes:**

- Stack: Backend (error middleware, Celery retry logic)
- Dependencies: All transaction-related stories
- Complexity Factors: Retry logic, idempotency, error categorization
- Monitoring: Sentry integration

**Estimation:** 8 Story Points  
**Priority:** MUST HAVE  
**Status:** üìã Backlog

---

### üü° SHOULD HAVE (Post-MVP Priority)

---

#### 24. Merchant Dashboard - Analytics

**ID:** US-024  
**Epic:** Analytics & Reporting  
**Story:** Como comerciante, quiero ver gr√°ficas y estad√≠sticas de mis ventas para entender mi negocio mejor

**Acceptance Criteria:**

- [ ] Gr√°fica de ventas diarias (√∫ltimos 30 d√≠as)
- [ ] Ventas totales del mes actual vs mes anterior
- [ ] M√©todo de pago preferido (NFC vs QR)
- [ ] Horarios de mayor venta
- [ ] Cliente promedio (ticket promedio)
- [ ] Exportar reporte a PDF

**Technical Notes:**

- Stack: React Native Business + Backend (aggregation queries)
- Dependencies: US-021 (transactions must exist)
- Complexity Factors: Data aggregation, chart libraries, PDF generation
- Libraries: Recharts (web), Victory Native (mobile)

**Estimation:** 13 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 25. P2P Transfers (User to User)

**ID:** US-025  
**Epic:** Cross-Border Transfers  
**Story:** Como usuario, quiero enviar dinero a otro usuario Wani local (mismo pa√≠s) sin comisi√≥n

**Acceptance Criteria:**

- [ ] Buscar usuario por email, tel√©fono, o Wani ID
- [ ] Seleccionar monto a enviar
- [ ] Confirmar env√≠o
- [ ] Transferencia instant√°nea (sin usar Stellar si es mismo pa√≠s)
- [ ] Sin comisi√≥n (P2P gratuito)
- [ ] Notificaci√≥n a ambos usuarios

**Technical Notes:**

- Stack: Frontend + Backend (direct database update, no blockchain)
- Dependencies: US-005, US-008
- Complexity Factors: User search, balance validation, instant transfer
- Performance: <1 second (no blockchain needed)

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 26. Biometric Authentication (Face ID / Fingerprint)

**ID:** US-026  
**Epic:** Advanced Security  
**Story:** Como usuario, quiero usar Face ID o huella digital para confirmar pagos de forma r√°pida y segura

**Acceptance Criteria:**

- [ ] Activar biometr√≠a en settings
- [ ] Usar biometr√≠a para: login, confirmar pagos >$500 MXN
- [ ] Fallback a PIN si biometr√≠a falla
- [ ] Biometr√≠a guardada localmente (no enviada al servidor)
- [ ] Compatible con Face ID (iOS), Touch ID (iOS), Fingerprint (Android)

**Technical Notes:**

- Stack: React Native (expo-local-authentication)
- Dependencies: US-002 (authentication flow)
- Complexity Factors: Platform-specific implementations, fallback logic
- Libraries: expo-local-authentication

**Estimation:** 5 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 27. Cashback Program

**ID:** US-027  
**Epic:** Rewards & Loyalty  
**Story:** Como usuario, quiero recibir cashback cuando pago en comercios Wani para tener incentivo de usar la app

**Acceptance Criteria:**

- [ ] 0.5% cashback en todos los pagos a comercios
- [ ] Cashback acreditado autom√°ticamente a wallet
- [ ] Ver cashback acumulado en perfil
- [ ] Historial de cashback recibido
- [ ] Notificaci√≥n cuando se acredita cashback

**Technical Notes:**

- Stack: Backend (automatic calculation post-payment)
- Dependencies: US-012, US-013 (payment stories)
- Complexity Factors: Cashback calculation, automatic crediting, business model impact
- Business: Revisar viabilidad econ√≥mica

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 28. Referral Program

**ID:** US-028  
**Epic:** Rewards & Loyalty  
**Story:** Como usuario, quiero invitar amigos a Wani y recibir un bono cuando ellos se registren y usen la app

**Acceptance Criteria:**

- [ ] Generar c√≥digo de referido √∫nico
- [ ] Compartir c√≥digo v√≠a WhatsApp, email, SMS
- [ ] Nuevo usuario ingresa c√≥digo al registrarse
- [ ] Ambos usuarios reciben $50 MXN cuando el referido haga su primera transacci√≥n >$500 MXN
- [ ] Ver lista de referidos y bonos ganados

**Technical Notes:**

- Stack: Frontend (share functionality) + Backend (referral tracking)
- Dependencies: US-001 (registration)
- Complexity Factors: Referral code generation, tracking, bonus crediting, fraud prevention

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 29. Merchant Subscription Plans

**ID:** US-029  
**Epic:** Merchant Features  
**Story:** Como comerciante alto volumen, quiero suscribirme a un plan mensual para pagar 0% comisi√≥n y ahorrar dinero

**Acceptance Criteria:**

- [ ] Planes disponibles: B√°sico ($200/mes hasta $100k), Pro ($500/mes hasta $500k)
- [ ] Cambiar de pay-as-you-go a suscripci√≥n
- [ ] Pago mensual autom√°tico con tarjeta
- [ ] L√≠mite de volumen visible en dashboard
- [ ] Alerta cuando se acerca al l√≠mite
- [ ] Opci√≥n de upgrade/downgrade

**Technical Notes:**

- Stack: Backend + Stripe/payment processor
- Dependencies: US-017, US-021
- Complexity Factors: Subscription management, volume tracking, payment processing, billing
- External: Stripe Subscriptions

**Estimation:** 13 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 30. Two-Factor Authentication (2FA)

**ID:** US-030  
**Epic:** Advanced Security  
**Story:** Como usuario, quiero activar 2FA para proteger mi cuenta con un c√≥digo adicional al hacer login

**Acceptance Criteria:**

- [ ] Activar 2FA con app autenticadora (Google Authenticator, Authy)
- [ ] Mostrar QR code para escanear
- [ ] Backup codes generados (imprimir/guardar)
- [ ] Al hacer login, pedir c√≥digo de 6 d√≠gitos
- [ ] Opci√≥n de desactivar 2FA (requiere c√≥digo)

**Technical Notes:**

- Stack: Backend (TOTP generation) + Frontend (QR display, code input)
- Dependencies: US-002 (login flow)
- Complexity Factors: TOTP implementation, backup codes, QR generation
- Libraries: pyotp (Python), speakeasy (Node.js alternative)

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 31. Transaction Limits based on KYC Level

**ID:** US-031  
**Epic:** Compliance & Risk Management  
**Story:** Como sistema, quiero imponer l√≠mites transaccionales seg√∫n el nivel KYC del usuario para cumplir regulaciones

**Acceptance Criteria:**

- [ ] KYC None: Max $1,000 MXN/transacci√≥n, $5,000 MXN/mes
- [ ] KYC Basic: Max $10,000 MXN/transacci√≥n, $50,000 MXN/mes
- [ ] KYC Full: Max $100,000 MXN/transacci√≥n, sin l√≠mite mensual
- [ ] Error claro cuando usuario excede l√≠mite
- [ ] Sugerencia de completar KYC para aumentar l√≠mites

**Technical Notes:**

- Stack: Backend (validation middleware)
- Dependencies: US-003 (KYC), US-008 (transactions)
- Complexity Factors: Limit tracking, monthly reset, KYC level checking
- Compliance: Mexican Ley Fintech requirements

**Estimation:** 5 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 32. Transaction Reports (for users)

**ID:** US-032  
**Epic:** Analytics & Reporting  
**Story:** Como usuario, quiero exportar mis transacciones a PDF o Excel para llevar mi contabilidad personal

**Acceptance Criteria:**

- [ ] Seleccionar rango de fechas
- [ ] Filtrar por tipo de transacci√≥n
- [ ] Exportar a PDF (formato bonito) o CSV (para Excel)
- [ ] Incluir: fecha, tipo, monto, comisi√≥n, contraparte, balance despu√©s
- [ ] Enviar por email o descargar

**Technical Notes:**

- Stack: Backend (report generation) + Frontend (download)
- Dependencies: US-010 (transaction history)
- Complexity Factors: PDF generation, CSV formatting, email attachment
- Libraries: ReportLab (Python PDF), pandas (CSV)

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 33. In-app Customer Support Chat

**ID:** US-033  
**Epic:** Support & Help  
**Story:** Como usuario, quiero chatear con soporte desde la app para resolver mis dudas r√°pidamente

**Acceptance Criteria:**

- [ ] Bot√≥n de "Ayuda" visible en todas las pantallas
- [ ] Chat en tiempo real con agente de soporte
- [ ] Ver historial de conversaciones anteriores
- [ ] Enviar screenshots
- [ ] Notificaci√≥n push cuando agente responde
- [ ] Horario de atenci√≥n visible

**Technical Notes:**

- Stack: Frontend + Backend + Chat service (Intercom, Zendesk)
- Dependencies: US-001 (user identity)
- Complexity Factors: Real-time messaging, file upload, notification integration
- External: Intercom or Zendesk Chat

**Estimation:** 13 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 34. Merchant Payout Schedule

**ID:** US-034  
**Epic:** Merchant Features  
**Story:** Como comerciante, quiero programar pagos autom√°ticos de mi wallet Wani a mi banco cada semana

**Acceptance Criteria:**

- [ ] Configurar payout autom√°tico: semanal, quincenal, mensual
- [ ] Seleccionar d√≠a de la semana/mes
- [ ] Monto: total disponible o monto fijo
- [ ] Cuenta bancaria destino guardada
- [ ] Confirmaci√≥n cuando payout se ejecuta
- [ ] Historial de payouts

**Technical Notes:**

- Stack: Backend (Celery scheduled tasks) + Bitso API
- Dependencies: US-015 (cash-out functionality)
- Complexity Factors: Scheduled tasks, error handling, retry logic
- Infrastructure: Celery Beat for scheduling

**Estimation:** 8 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

#### 35. Advanced Fraud Detection

**ID:** US-035  
**Epic:** Security & Compliance  
**Story:** Como sistema, quiero detectar patrones sospechosos de fraude y bloquear transacciones riesgosas autom√°ticamente

**Acceptance Criteria:**

- [ ] Detectar: m√∫ltiples transacciones r√°pidas, montos inusuales, nuevos dispositivos, geolocalizaci√≥n inesperada
- [ ] Bloquear transacci√≥n sospechosa autom√°ticamente
- [ ] Notificar usuario por email/SMS para confirmar transacci√≥n
- [ ] Dashboard admin para revisar casos flagged
- [ ] Machine learning b√°sico (scoring)

**Technical Notes:**

- Stack: Backend (fraud rules engine) + ML model (future)
- Dependencies: All transaction stories
- Complexity Factors: Rule engine, ML model training, false positive management
- Post-MVP: Start with rules, evolve to ML

**Estimation:** 21 Story Points  
**Priority:** SHOULD HAVE  
**Status:** üìã Backlog

---

### üü¢ COULD HAVE (Nice to Have)

---

#### 36. Scheduled Payments (Recurring)

**ID:** US-036  
**Epic:** Advanced Features  
**Story:** Como usuario, quiero programar pagos recurrentes autom√°ticos (ej: renta mensual, remesa familiar)

**Estimation:** 13 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 37. Multi-Currency Wallet

**ID:** US-037  
**Epic:** Advanced Features  
**Story:** Como usuario, quiero mantener saldo en USD, CAD y MXN simult√°neamente y convertir entre ellos

**Estimation:** 13 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 38. Savings Goals

**ID:** US-038  
**Epic:** Financial Products  
**Story:** Como usuario, quiero crear metas de ahorro y separar dinero para alcanzarlas

**Estimation:** 8 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 39. Credit Line (based on transaction history)

**ID:** US-039  
**Epic:** Financial Products  
**Story:** Como usuario con historial de pagos, quiero acceder a una l√≠nea de cr√©dito

**Estimation:** 21 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 40. Merchant Loyalty Programs

**ID:** US-040  
**Epic:** Rewards & Loyalty  
**Story:** Como comerciante, quiero crear programas de lealtad para mis clientes (puntos, descuentos)

**Estimation:** 13 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 41. Bill Payments (CFE, Telmex, etc.)

**ID:** US-041  
**Epic:** Integrations  
**Story:** Como usuario, quiero pagar mis servicios (luz, agua, internet) desde Wani

**Estimation:** 21 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

#### 42. Expansion to Colombia, Peru, Chile

**ID:** US-042  
**Epic:** Geographic Expansion  
**Story:** Como usuario en otros pa√≠ses LATAM, quiero usar Wani en mi pa√≠s

**Estimation:** 34 Story Points  
**Priority:** COULD HAVE  
**Status:** üìã Backlog

---

### ‚ö™ WON'T HAVE (Out of Scope - MVP)

- **Investments/Trading:** Fuera del core business de pagos - Raz√≥n: Requiere diferentes regulaciones
- **Pr√©stamos P2P:** Demasiado complejo regulatoriamente - Raz√≥n: Enfoque en pagos primero
- **Tarjeta f√≠sica:** Hardware costoso y log√≠stica compleja - Raz√≥n: Virtual wallet suficiente para MVP
- **Integraci√≥n con POS f√≠sicos de terceros:** Requiere partnerships complejos - Raz√≥n: Celular como POS es m√°s simple
- **Cripto trading:** No es el objetivo del producto - Raz√≥n: Blockchain es infraestructura invisible
- **Pagos internacionales fuera de USA/CAN/MX:** Scope demasiado amplio - Raz√≥n: Enfoque en un corredor primero

---

## Definition of Ready (DoR)

Una User Story est√° "Ready" para Sprint Planning cuando:

- [ ] Tiene descripci√≥n clara en formato "Como X, quiero Y, para Z"
- [ ] Tiene Acceptance Criteria espec√≠ficos y medibles
- [ ] Tiene estimaci√≥n de complejidad (Story Points)
- [ ] Dependencias t√©cnicas identificadas
- [ ] Dudas o incertidumbres t√©cnicas resueltas con el equipo
- [ ] Es lo suficientemente peque√±a para completarse en 1 sprint
- [ ] Tiene prioridad MoSCoW asignada
- [ ] Epic asignado (si aplica)

---

## Definition of Done (DoD)

Una User Story est√° "Done" cuando:

- [ ] Todos los Acceptance Criteria cumplidos al 100%
- [ ] C√≥digo funcional y testeado manualmente
- [ ] Tests unitarios escritos (coverage >80% para l√≥gica cr√≠tica)
- [ ] Sin bugs cr√≠ticos o blockers
- [ ] Code review completado (si es equipo, self-review si es individual)
- [ ] Documentaci√≥n b√°sica actualizada (si aplica)
- [ ] Deployado en ambiente de staging
- [ ] Demo preparado para Sprint Review
- [ ] Cliente/usuario puede validar la funcionalidad

---

## Backlog Refinement Notes

**Frequency:** Cada semana (mid-sprint)  
**Next Review:** TBD (start Sprint 1 first)

**Items que necesitan refinamiento:**

- [ ] US-035 (Advanced Fraud Detection) - Demasiado grande, dividir en reglas b√°sicas vs ML
- [ ] US-029 (Merchant Subscriptions) - Definir pricing exacto y flujo de pago
- [ ] US-039 (Credit Line) - Requiere an√°lisis de riesgo m√°s profundo

---

## Sprint Velocity Tracking

Actualizar despu√©s de cada sprint completado:

| Sprint   | Planned Points | Completed Points | Velocity | Notes |
| -------- | -------------- | ---------------- | -------- | ----- |
| Sprint 1 | -              | -                | -        | TBD   |
| Sprint 2 | -              | -                | -        | TBD   |
| Sprint 3 | -              | -                | -        | TBD   |
| Sprint 4 | -              | -                | -        | TBD   |
| Sprint 5 | -              | -                | -        | TBD   |
| Sprint 6 | -              | -                | -        | TBD   |
| Sprint 7 | -              | -                | -        | TBD   |
| Sprint 8 | -              | -                | -        | TBD   |

**Target Velocity:** 17 Story Points/sprint (assumption for MVP planning)  
**Average Velocity:** TBD (calculate after Sprint 3)

---

## Quick Actions

### Para Sprint Planning:

1. Filtrar por "MUST HAVE" + Status "Backlog"
2. Ordenar por prioridad num√©rica (US-001, US-002...)
3. Respetar dependencias t√©cnicas
4. Seleccionar ~17 Story Points seg√∫n velocity
5. Validar que todas las stories seleccionadas tienen DoR completo

### Para agregar nueva story:

1. Escribir en formato "Como [rol], quiero [acci√≥n], para [beneficio]"
2. Definir Acceptance Criteria claros
3. Estimar complejidad (Story Points)
4. Asignar prioridad MoSCoW
5. Identificar dependencias
6. Asignar Epic (si aplica)
7. Agregar en secci√≥n correspondiente (Must/Should/Could)
8. Actualizar "Total Items" en Backlog Summary

### Para mover story entre prioridades:

1. Evaluar impacto en MVP
2. Consultar con stakeholders (si hay)
3. Actualizar secci√≥n correspondiente
4. Actualizar Backlog Summary
5. Documentar raz√≥n del cambio en Notes

---

## Notes & Assumptions

**Assumptions for Estimation:**

- 1 Sprint = 2 semanas
- Velocity estimada: 17 Story Points/sprint (ajustar despu√©s de Sprint 3)
- Stories >13 points probablemente necesitan dividirse
- Complejidad considera: esfuerzo t√©cnico + incertidumbre + dependencias

**Technical Dependencies Chain:**

1. **Auth First:** US-001, US-002 (nada funciona sin auth)
2. **Wallet Core:** US-004, US-005 (todo depende de tener wallet)
3. **Load Money:** US-006 o US-007 (necesario antes de transactions)
4. **Transactions:** US-008, US-009 (core feature)
5. **Payments:** US-011, US-012, US-013 (requieren wallet con balance)
6. **Merchant:** US-017, US-018, US-019, US-020 (parallel track)

**Recommended Sprint Sequence:**

- Sprint 1-2: Auth + KYC + Wallet core (US-001 to US-005)
- Sprint 3-4: Load money + Cross-border transfers (US-006, US-007, US-008, US-009, US-010)
- Sprint 5-6: NFC/QR Payments (US-011, US-012, US-013)
- Sprint 7: Merchant features (US-017, US-018, US-019, US-020, US-021)
- Sprint 8: Cash-out + Notifications + Polish (US-014, US-015, US-016, US-022, US-023)

---

**Last Updated:** 2024-12-20  
**Next Review:** After Sprint 1 Planning  
**Maintained by:** [Tu Nombre]

---

**End of PRODUCT-BACKLOG.md v1.0**
